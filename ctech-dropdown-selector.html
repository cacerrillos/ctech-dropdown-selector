<!doctype html>
<dom-module id="ctech-dropdown-selector">
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-menu-button/paper-menu-button.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-menu/paper-menu.html">
<link rel="import" href="../paper-item/paper-item.html">
<style is="custom-style">
	.but {
		background-color: #4285f4;
		color: rgba(255,255,255,1.00);
	}
</style>
<template>
	<paper-menu-button>
		<paper-button class="dropdown-trigger" id="currentButton" raised="[[raised]]"><div>[[selectedText]]</div></paper-button>
		<paper-menu id="dropdownSelector" class="dropdown-content" on-iron-select="onSelectedInternalChange">
			<paper-item id="defaultItem">[[defaultText]]</paper-item>
			<template is="dom-repeat" items="[[objects]]" as="row">
				<paper-item data-id="[[_itemGetAttribute(row, attrForSelected)]]">[[_itemGetAttribute(row, attrForText)]]</paper-item>
			</template>
		</paper-menu>
	</paper-menu-button>
</template>
<script>
Polymer({
	is: "ctech-dropdown-selector",
	properties: {
		value: {
			type: String,
			value: "-1"
		},
		raised: Boolean,
		name: String,
		attrForSelected: {
			type: String,
			value: 'id'
		},
		attrForText: {
			type: String,
			value: 'name'
		},
		objects: {
			type: Object,
			observer: "onobjchange"
		},
		selected: {
			type: Object,
			observer: "onSelectedChange",
			readonly: true,
			notify: true
		},
		defaultText: {
			type: String,
			value: "_____"
		},
		selectedText: {
			type: String
		},
		selectedInternal: Number
	},
	onobjchange: function(e){
		this.redraww();
	},
	_itemGetAttribute: function(item, attribute) {
		return item[attribute];
	},
	onSelectedChange: function(e) {
		this.redraww();
		return;
		if(this.objects){
			this.selectedInternal = e + 1;
			this.redraww();
			if(this.selected >= 0 && this.selected < this.objects.length){
				this.value = this.objects[this.selected].id;
				this.fire("selected-changed", { selected: this.objects[this.selected].id });
			} else {
				this.value = -1;
				this.fire("selected-changed", { });
			}
			
		}
	},
	select: function() {

	},
	redraww: function(){
		if(this.selected){
			this.selectedText = this.selected[this.attrForText];
			this.$.currentButton.style.fontWeight = "bold";
			this.$.currentButton.style.color = "#2196F3";
		} else {
			this.selectedText = this.defaultText;
			this.$.currentButton.style.fontWeight = "normal";
			this.$.currentButton.style.color = "#212121";
		}
	},
	onSelectedInternalChange: function(e){
		this.selected = this.$.dropdownSelector.selected > 0 ? this.objects[this.$.dropdownSelector.selected - 1] : null;
	},
	_trans: function(data){
		return data + 1;
	},
	ready: function(){
		this.selectedText = this.defaultText;
	}
});
</script>
</dom-module>